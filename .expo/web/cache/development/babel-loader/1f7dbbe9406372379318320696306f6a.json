{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport { generateDatabaseId, isBoolean, isFunction, isNull, isNumber, isObject, isString, isUndefined, isValidPath, pathChild, pathParent, promiseWithOptionalCallback } from '@react-native-firebase/app/lib/common';\nimport DatabaseDataSnapshot from \"./DatabaseDataSnapshot\";\nimport DatabaseOnDisconnect from \"./DatabaseOnDisconnect\";\nimport DatabaseQuery, { provideReferenceClass as provideReferenceClassForQuery } from \"./DatabaseQuery\";\nimport DatabaseQueryModifiers from \"./DatabaseQueryModifiers\";\nimport DatabaseThenableReference, { provideReferenceClass as provideReferenceClassForThenable } from \"./DatabaseThenableReference\";\nvar internalRefs = ['.info/connected', '.info/serverTimeOffset'];\n\nvar DatabaseReference = function (_DatabaseQuery) {\n  _inherits(DatabaseReference, _DatabaseQuery);\n\n  var _super = _createSuper(DatabaseReference);\n\n  function DatabaseReference(database, path) {\n    var _this;\n\n    _classCallCheck(this, DatabaseReference);\n\n    if (!internalRefs.includes(path) && !isValidPath(path)) {\n      throw new Error('firebase.database() Paths must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\"');\n    }\n\n    _this = _super.call(this, database, path, new DatabaseQueryModifiers());\n    _this._database = database;\n    return _this;\n  }\n\n  _createClass(DatabaseReference, [{\n    key: \"child\",\n    value: function child(path) {\n      if (!isString(path)) {\n        throw new Error(\"firebase.database().ref().child(*) 'path' must be a string value.\");\n      }\n\n      return new DatabaseReference(this._database, pathChild(this.path, path));\n    }\n  }, {\n    key: \"set\",\n    value: function set(value, onComplete) {\n      if (isUndefined(value)) {\n        throw new Error(\"firebase.database().ref().set(*) 'value' must be defined.\");\n      }\n\n      if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n        throw new Error(\"firebase.database().ref().set(_, *) 'onComplete' must be a function if provided.\");\n      }\n\n      return promiseWithOptionalCallback(this._database.native.set(this.path, {\n        value: value\n      }), onComplete);\n    }\n  }, {\n    key: \"update\",\n    value: function update(values, onComplete) {\n      if (!isObject(values)) {\n        throw new Error(\"firebase.database().ref().update(*) 'values' must be an object.\");\n      }\n\n      if (!Object.keys(values).length) {\n        throw new Error(\"firebase.database().ref().update(*) 'values' must be an object containing multiple values.\");\n      }\n\n      var keys = Object.keys(values);\n\n      for (var i = 0; i < keys.length; i++) {\n        if (!isValidPath(keys[i])) {\n          throw new Error('firebase.database().update(*) \\'values\\' contains an invalid path. Paths must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\"');\n        }\n      }\n\n      if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n        throw new Error(\"firebase.database().ref().update(_, *) 'onComplete' must be a function if provided.\");\n      }\n\n      return promiseWithOptionalCallback(this._database.native.update(this.path, {\n        values: values\n      }), onComplete);\n    }\n  }, {\n    key: \"setWithPriority\",\n    value: function setWithPriority(newVal, newPriority, onComplete) {\n      if (isUndefined(newVal)) {\n        throw new Error(\"firebase.database().ref().setWithPriority(*) 'newVal' must be defined.\");\n      }\n\n      if (!isNumber(newPriority) && !isString(newPriority) && !isNull(newPriority)) {\n        throw new Error(\"firebase.database().ref().setWithPriority(_, *) 'newPriority' must be a number, string or null value.\");\n      }\n\n      if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n        throw new Error(\"firebase.database().ref().setWithPriority(_, _, *) 'onComplete' must be a function if provided.\");\n      }\n\n      return promiseWithOptionalCallback(this._database.native.setWithPriority(this.path, {\n        value: newVal,\n        priority: newPriority\n      }), onComplete);\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(onComplete) {\n      if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n        throw new Error(\"firebase.database().ref().remove(*) 'onComplete' must be a function if provided.\");\n      }\n\n      return promiseWithOptionalCallback(this._database.native.remove(this.path), onComplete);\n    }\n  }, {\n    key: \"transaction\",\n    value: function transaction(transactionUpdate, onComplete, applyLocally) {\n      var _this2 = this;\n\n      if (!isFunction(transactionUpdate)) {\n        throw new Error(\"firebase.database().ref().transaction(*) 'transactionUpdate' must be a function.\");\n      }\n\n      if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n        throw new Error(\"firebase.database().ref().transaction(_, *) 'onComplete' must be a function if provided.\");\n      }\n\n      if (!isUndefined(applyLocally) && !isBoolean(applyLocally)) {\n        throw new Error(\"firebase.database().ref().transaction(_, _, *) 'applyLocally' must be a boolean value if provided.\");\n      }\n\n      return new Promise(function (resolve, reject) {\n        var onCompleteWrapper = function onCompleteWrapper(error, committed, snapshotData) {\n          if (isFunction(onComplete)) {\n            if (error) {\n              onComplete(error, committed, null);\n            } else {\n              onComplete(null, committed, new DatabaseDataSnapshot(_this2, snapshotData));\n            }\n          }\n\n          if (error) {\n            return reject(error);\n          }\n\n          return resolve({\n            committed: committed,\n            snapshot: new DatabaseDataSnapshot(_this2, snapshotData)\n          });\n        };\n\n        _this2._database._transaction.add(_this2, transactionUpdate, onCompleteWrapper, applyLocally);\n      });\n    }\n  }, {\n    key: \"setPriority\",\n    value: function setPriority(priority, onComplete) {\n      if (!isNumber(priority) && !isString(priority) && !isNull(priority)) {\n        throw new Error(\"firebase.database().ref().setPriority(*) 'priority' must be a number, string or null value.\");\n      }\n\n      if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n        throw new Error(\"firebase.database().ref().setPriority(_, *) 'onComplete' must be a function if provided.\");\n      }\n\n      return promiseWithOptionalCallback(this._database.native.setPriority(this.path, {\n        priority: priority\n      }), onComplete);\n    }\n  }, {\n    key: \"push\",\n    value: function push(value, onComplete) {\n      if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n        throw new Error(\"firebase.database().ref().push(_, *) 'onComplete' must be a function if provided.\");\n      }\n\n      var id = generateDatabaseId(this._database._serverTimeOffset);\n\n      if (isUndefined(value) || isNull(value)) {\n        return new DatabaseThenableReference(this._database, pathChild(this.path, id), Promise.resolve(this.child(id)));\n      }\n\n      var pushRef = this.child(id);\n      var promise = pushRef.set(value, onComplete).then(function () {\n        return pushRef;\n      });\n\n      if (onComplete) {\n        promise.catch(function () {});\n      }\n\n      return new DatabaseThenableReference(this._database, pathChild(this.path, id), promise);\n    }\n  }, {\n    key: \"onDisconnect\",\n    value: function onDisconnect() {\n      return new DatabaseOnDisconnect(this);\n    }\n  }, {\n    key: \"parent\",\n    get: function get() {\n      var parentPath = pathParent(this.path);\n\n      if (parentPath === null) {\n        return null;\n      }\n\n      return new DatabaseReference(this._database, parentPath);\n    }\n  }, {\n    key: \"root\",\n    get: function get() {\n      return new DatabaseReference(this._database, '/');\n    }\n  }]);\n\n  return DatabaseReference;\n}(DatabaseQuery);\n\nexport { DatabaseReference as default };\nprovideReferenceClassForQuery(DatabaseReference);\nprovideReferenceClassForThenable(DatabaseReference);","map":{"version":3,"sources":["C:/Users/Dell/hackathon/system_campus/node_modules/@react-native-firebase/database/lib/DatabaseReference.js"],"names":["generateDatabaseId","isBoolean","isFunction","isNull","isNumber","isObject","isString","isUndefined","isValidPath","pathChild","pathParent","promiseWithOptionalCallback","DatabaseDataSnapshot","DatabaseOnDisconnect","DatabaseQuery","provideReferenceClass","provideReferenceClassForQuery","DatabaseQueryModifiers","DatabaseThenableReference","provideReferenceClassForThenable","internalRefs","DatabaseReference","database","path","includes","Error","_database","value","onComplete","native","set","values","Object","keys","length","i","update","newVal","newPriority","setWithPriority","priority","remove","transactionUpdate","applyLocally","Promise","resolve","reject","onCompleteWrapper","error","committed","snapshotData","snapshot","_transaction","add","setPriority","id","_serverTimeOffset","child","pushRef","promise","then","catch","parentPath"],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2016-present Invertase Limited & Contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this library except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\nimport {\n  generateDatabaseId,\n  isBoolean,\n  isFunction,\n  isNull,\n  isNumber,\n  isObject,\n  isString,\n  isUndefined,\n  isValidPath,\n  pathChild,\n  pathParent,\n  promiseWithOptionalCallback,\n} from '@react-native-firebase/app/lib/common';\nimport DatabaseDataSnapshot from './DatabaseDataSnapshot';\nimport DatabaseOnDisconnect from './DatabaseOnDisconnect';\nimport DatabaseQuery, {\n  provideReferenceClass as provideReferenceClassForQuery,\n} from './DatabaseQuery';\nimport DatabaseQueryModifiers from './DatabaseQueryModifiers';\nimport DatabaseThenableReference, {\n  provideReferenceClass as provideReferenceClassForThenable,\n} from './DatabaseThenableReference';\n\nconst internalRefs = ['.info/connected', '.info/serverTimeOffset'];\n\nexport default class DatabaseReference extends DatabaseQuery {\n  constructor(database, path) {\n    // Validate the reference path\n    if (!internalRefs.includes(path) && !isValidPath(path)) {\n      throw new Error(\n        'firebase.database() Paths must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\"',\n      );\n    }\n\n    super(database, path, new DatabaseQueryModifiers());\n    this._database = database;\n  }\n\n  /**\n   * @url https://firebase.google.com/docs/reference/js/firebase.database.Reference.html#parent\n   */\n  get parent() {\n    const parentPath = pathParent(this.path);\n    if (parentPath === null) {\n      return null;\n    }\n    return new DatabaseReference(this._database, parentPath);\n  }\n\n  /**\n   * @url https://firebase.google.com/docs/reference/js/firebase.database.Reference.html#root\n   */\n  get root() {\n    return new DatabaseReference(this._database, '/');\n  }\n\n  /**\n   * @url https://firebase.google.com/docs/reference/js/firebase.database.Reference.html#child\n   * @param path\n   */\n  child(path) {\n    if (!isString(path)) {\n      throw new Error(\"firebase.database().ref().child(*) 'path' must be a string value.\");\n    }\n    return new DatabaseReference(this._database, pathChild(this.path, path));\n  }\n\n  /**\n   * @url https://firebase.google.com/docs/reference/js/firebase.database.Reference.html#set\n   * @param value\n   * @param onComplete\n   */\n  set(value, onComplete) {\n    if (isUndefined(value)) {\n      throw new Error(\"firebase.database().ref().set(*) 'value' must be defined.\");\n    }\n\n    if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n      throw new Error(\n        \"firebase.database().ref().set(_, *) 'onComplete' must be a function if provided.\",\n      );\n    }\n\n    return promiseWithOptionalCallback(this._database.native.set(this.path, { value }), onComplete);\n  }\n\n  /**\n   * @url https://firebase.google.com/docs/reference/js/firebase.database.Reference.html#update\n   * @param values\n   * @param onComplete\n   */\n  update(values, onComplete) {\n    if (!isObject(values)) {\n      throw new Error(\"firebase.database().ref().update(*) 'values' must be an object.\");\n    }\n\n    if (!Object.keys(values).length) {\n      throw new Error(\n        \"firebase.database().ref().update(*) 'values' must be an object containing multiple values.\",\n      );\n    }\n\n    const keys = Object.keys(values);\n    for (let i = 0; i < keys.length; i++) {\n      if (!isValidPath(keys[i])) {\n        throw new Error(\n          'firebase.database().update(*) \\'values\\' contains an invalid path. Paths must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\"',\n        );\n      }\n    }\n\n    if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n      throw new Error(\n        \"firebase.database().ref().update(_, *) 'onComplete' must be a function if provided.\",\n      );\n    }\n\n    return promiseWithOptionalCallback(\n      this._database.native.update(this.path, { values }),\n      onComplete,\n    );\n  }\n\n  /**\n   * @url https://firebase.google.com/docs/reference/js/firebase.database.Reference#setwithpriority\n   * @param newVal\n   * @param newPriority\n   * @param onComplete\n   */\n  setWithPriority(newVal, newPriority, onComplete) {\n    if (isUndefined(newVal)) {\n      throw new Error(\"firebase.database().ref().setWithPriority(*) 'newVal' must be defined.\");\n    }\n\n    if (!isNumber(newPriority) && !isString(newPriority) && !isNull(newPriority)) {\n      throw new Error(\n        \"firebase.database().ref().setWithPriority(_, *) 'newPriority' must be a number, string or null value.\",\n      );\n    }\n\n    if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n      throw new Error(\n        \"firebase.database().ref().setWithPriority(_, _, *) 'onComplete' must be a function if provided.\",\n      );\n    }\n\n    return promiseWithOptionalCallback(\n      this._database.native.setWithPriority(this.path, {\n        value: newVal,\n        priority: newPriority,\n      }),\n      onComplete,\n    );\n  }\n\n  /**\n   * @url https://firebase.google.com/docs/reference/js/firebase.database.Reference#remove\n   * @param onComplete\n   */\n  remove(onComplete) {\n    if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n      throw new Error(\n        \"firebase.database().ref().remove(*) 'onComplete' must be a function if provided.\",\n      );\n    }\n\n    return promiseWithOptionalCallback(this._database.native.remove(this.path), onComplete);\n  }\n\n  /**\n   * @url https://firebase.google.com/docs/reference/js/firebase.database.Reference#transaction\n   * @param transactionUpdate\n   * @param onComplete\n   * @param applyLocally\n   */\n  transaction(transactionUpdate, onComplete, applyLocally) {\n    if (!isFunction(transactionUpdate)) {\n      throw new Error(\n        \"firebase.database().ref().transaction(*) 'transactionUpdate' must be a function.\",\n      );\n    }\n\n    if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n      throw new Error(\n        \"firebase.database().ref().transaction(_, *) 'onComplete' must be a function if provided.\",\n      );\n    }\n\n    if (!isUndefined(applyLocally) && !isBoolean(applyLocally)) {\n      throw new Error(\n        \"firebase.database().ref().transaction(_, _, *) 'applyLocally' must be a boolean value if provided.\",\n      );\n    }\n\n    return new Promise((resolve, reject) => {\n      const onCompleteWrapper = (error, committed, snapshotData) => {\n        if (isFunction(onComplete)) {\n          if (error) {\n            onComplete(error, committed, null);\n          } else {\n            onComplete(null, committed, new DatabaseDataSnapshot(this, snapshotData));\n          }\n        }\n\n        if (error) {\n          return reject(error);\n        }\n        return resolve({\n          committed,\n          snapshot: new DatabaseDataSnapshot(this, snapshotData),\n        });\n      };\n\n      // start the transaction natively\n      this._database._transaction.add(this, transactionUpdate, onCompleteWrapper, applyLocally);\n    });\n  }\n\n  /**\n   * @url https://firebase.google.com/docs/reference/js/firebase.database.Reference#setpriority\n   * @param priority\n   * @param onComplete\n   */\n  setPriority(priority, onComplete) {\n    if (!isNumber(priority) && !isString(priority) && !isNull(priority)) {\n      throw new Error(\n        \"firebase.database().ref().setPriority(*) 'priority' must be a number, string or null value.\",\n      );\n    }\n\n    if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n      throw new Error(\n        \"firebase.database().ref().setPriority(_, *) 'onComplete' must be a function if provided.\",\n      );\n    }\n\n    return promiseWithOptionalCallback(\n      this._database.native.setPriority(this.path, { priority }),\n      onComplete,\n    );\n  }\n\n  /**\n   * @url https://firebase.google.com/docs/reference/js/firebase.database.Reference#push\n   * @param value\n   * @param onComplete\n   * @returns {DatabaseReference}\n   */\n  push(value, onComplete) {\n    if (!isUndefined(onComplete) && !isFunction(onComplete)) {\n      throw new Error(\n        \"firebase.database().ref().push(_, *) 'onComplete' must be a function if provided.\",\n      );\n    }\n\n    const id = generateDatabaseId(this._database._serverTimeOffset);\n\n    if (isUndefined(value) || isNull(value)) {\n      return new DatabaseThenableReference(\n        this._database,\n        pathChild(this.path, id),\n        Promise.resolve(this.child(id)),\n      );\n    }\n\n    const pushRef = this.child(id);\n\n    const promise = pushRef.set(value, onComplete).then(() => pushRef);\n\n    // Prevent unhandled promise rejection if onComplete is passed\n    if (onComplete) {\n      promise.catch(() => {});\n    }\n\n    return new DatabaseThenableReference(this._database, pathChild(this.path, id), promise);\n  }\n\n  /**\n   * @url https://firebase.google.com/docs/reference/js/firebase.database.Reference#ondisconnect\n   */\n  onDisconnect() {\n    return new DatabaseOnDisconnect(this);\n  }\n}\n\n// To avoid React Native require cycle warnings\nprovideReferenceClassForQuery(DatabaseReference);\nprovideReferenceClassForThenable(DatabaseReference);\n"]},"metadata":{},"sourceType":"module"}